{"remainingRequest":"D:\\001JavaTools\\001Java项目\\招聘系统\\recruit-system\\recruit-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\001JavaTools\\001Java项目\\招聘系统\\recruit-system\\recruit-web\\src\\view\\resume\\detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\001JavaTools\\001Java项目\\招聘系统\\recruit-system\\recruit-web\\src\\view\\resume\\detail.vue","mtime":1720340953658},{"path":"D:\\001JavaTools\\001Java项目\\招聘系统\\recruit-system\\recruit-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\001JavaTools\\001Java项目\\招聘系统\\recruit-system\\recruit-web\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\001JavaTools\\001Java项目\\招聘系统\\recruit-system\\recruit-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\001JavaTools\\001Java项目\\招聘系统\\recruit-system\\recruit-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\001JavaTools\\001Java项目\\招聘系统\\recruit-system\\recruit-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1655715099000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Title from \"../../component/Title/index.vue\";\nimport Content from \"../../component/Content/index.vue\";\nimport moment from 'moment';\nimport exportPDF from './export-pdf'\nimport {\n  Resume\n} from '@/model/resume'\nexport default {\n  name: \"Detail\",\n  components: {\n    Title,\n    Content,\n  },\n  props: {\n    id: String,\n  },\n  watch: {\n    id(now, old) {\n      this.updataInfo(now)\n    }\n  },\n  data() {\n    return {\n      downloading: false,\n      model: \"p\",\n      // 基本信息\n      // 头像照片\n      avatar: \"\",\n      jobIntention: \"\",\n      name: \"\",\n      sex: \"\",\n      age: \"\",\n      english: \"\",\n      tel: \"1\",\n      email: \"\",\n      home: \"\",\n      // 教育经历\n      educations: [{\n        name: \"\",\n        start_time: \"\",\n        end_time: \"\",\n        major: \"\",\n        diploma: \"\",\n        descriptions: \"\",\n      },],\n      // 专业技能\n      ability: {\n        // 专业技能显示模式，ol为有序列表（前面是数字），ul为无序列表（前面是圆点），p为段落\n        skillsMode: 'p',\n        descriptions: \"\",\n      },\n      // 项目经历\n      projects: [{\n        name: \"\",\n        start_time: \"\",\n        end_time: \"\",\n        major: \"\",\n        // 项目背景显示模式，ol为有序列表（前面是数字），ul为无序列表（前面是圆点），p为段落\n        backgroundMode: 'ol',\n        background: '',\n        performance: \"\"\n      },],\n      // 实习经历\n      experiences: [{\n        name: \"\",\n        start_time: \"\",\n        end_time: \"\",\n        position: \"\",\n        performance: \"\",\n      },],\n      // 个人评价\n      evaluate: {\n        // 个人评价显示模式，ol为有序列表（前面是数字），ul为无序列表（前面是圆点），p为段落\n        wordMode: 'p',\n        word: ''\n      },\n      defaultImg: require(\"@/assets/image/user/user.png\")\n    };\n  },\r\n/*  async beforeUpdate(){\r\n\t this.imageUrlToBase64()\r\n\t console.log(\"onloade\") \r\n  }, */\n  async mounted() {\n    try {\n      if (this.id === null || this.id == '' || this.id == \"null\") return\n      const res = await Resume.getById(this.id)\n      // console.log(res)\n      this.ability.descriptions = res.ability,\r\n\t  //ttyyds:添加了前缀\n        this.avatar = \"http://localhost:5000/assets/\"+res.avatar ? res.avatar : this.defaultImg,\n        this.educations = res.educations,\n        this.experiences = res.experiences,\n        this.projects = res.projects,\n        this.jobIntention = res.job_intention,\n        this.english = res.english,\n        this.name = res.name,\n        this.sex = res.sex === 0 ? \"男\" : \"女\",\n        this.evaluate.word = res.personal_summary,\n        this.tel = res.tel.substring(0, 3)+\"****\"+res.tel.substr(res.tel.length-4),\n        this.age = res.age,\n        this.email = res.email,\n        this.home = res.home\n\n    } catch (error) {\n      console.log(error)\n    } finally {\n      this.imageUrlToBase64()\n    }\n  },\n  created() { },\n  methods: {\n    imageUrlToBase64() {\n      //一定要设置为let，不然图片不显示\n      let image = new Image();\n      //解决跨域问题\n      image.setAttribute('crossOrigin', 'anonymous');\n      let imageUrl = this.avatar;\n      image.src =imageUrl\n      let that = this;\n      //image.onload为异步加载\n      image.onload = () => {\n        var canvas = document.createElement(\"canvas\");\n        canvas.width = image.width;\n        canvas.height = image.height;\n        var context = canvas.getContext('2d');\n        context.drawImage(image, 0, 0, image.width, image.height);\n        var quality = 0.8;\n        //这里的dataurl就是base64类型\n        var dataURL = canvas.toDataURL(\"image/jpeg\", quality);//使用toDataUrl将图片转换成jpeg的格式,不要把图片压缩成png，因为压缩成png后base64的字符串可能比不转换前的长！          \n        that.avatar = dataURL\n      }\n    },\n    exportPDF() {\n      try {\n        this.downloading = true\n        this.imageUrlToBase64()\n        exportPDF.exportPdf(\"downResume\", this.name + \"-\" + this.jobIntention)\n      } catch (err) {\n        this.$message.error(\"导出简历发生错误\")\n        this.downloading = false\n      } finally {\n        this.downloading = false;\n        this.$message.success(\"导出简历成功\")\n      }\n    },\n    changeDiploma(value) {\n      if (value == 0) return \"高中\"\n      else if (value == 1) return \"大学专科\"\n      else if (value == 2) return \"大学本科\"\n      else if (value == 3) return \"硕士研究生\"\n      else if (value == 4) return \"博士研究生\"\n      else return \"\"\n    },\n    dateformat(date) {\n      return moment(date).format(\"YYYY\")\n    },\n    monthformat(date) {\n      return moment(date).format(\"YYYY.MM\")\n    },\n    async updataInfo(nowid) {\n      try {\n        const res = await Resume.getById(nowid)\n        console.log(res)\n        this.ability.descriptions = res.ability,\n          this.avatar = res.avatar,\n          this.educations = res.educations,\n          this.experiences = res.experiences,\n          this.projects = res.projects,\n          this.jobIntention = res.job_intention,\n          this.english = res.english,\n          this.name = res.name,\n          this.sex = res.sex === 0 ? \"男\" : \"女\",\n          this.evaluate.word = res.personal_summary,\n          this.tel = res.tel,\n          this.age = res.age,\n          this.email = res.email,\n          this.home = res.home\n      } catch (error) {\n        console.log(error)\n      } finally { \r\n\t\t  \r\n\t  }\n    }\n  },\n};\n",null]}